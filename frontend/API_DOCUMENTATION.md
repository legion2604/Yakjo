# Yakjo API Documentation v1

–ë–∞–∑–æ–≤—ã–π URL: `https://api.yakjo.tj/v1`
–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö: `application/json`
–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: HttpOnly Cookies (—Å–µ—Å—Å–∏–æ–Ω–Ω–∞—è)

---

## üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (Auth)

### 1. –û—Ç–ø—Ä–∞–≤–∫–∞ OTP –∫–æ–¥–∞
–ó–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ 4-–∑–Ω–∞—á–Ω–æ–≥–æ –∫–æ–¥–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞.
- **URL:** `/auth/send-otp`
- **–ú–µ—Ç–æ–¥:** `POST`
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  { "phone": "+992900000000" }
  ```
- **–û—Ç–≤–µ—Ç (200 OK):**
  ```json
  { "message": "–ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω" }
  ```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –∏ –í—Ö–æ–¥
–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–æ–¥–∞. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç ‚Äî –æ–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
- **URL:** `/auth/verify-otp`
- **–ú–µ—Ç–æ–¥:** `POST`
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  { "phone": "+992900000000", "code": "1234" }
  ```
- **–û—Ç–≤–µ—Ç (200 OK):** –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç HttpOnly Cookie.
  ```json
  {
    "id": "uuid",
    "firstName": "–ò–º—è",
    "phone": "+992900000000",
    "avatarUrl": "url",
    "isNewUser": true 
  }
  ```
> **–õ–æ–≥–∏–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:** –ï—Å–ª–∏ `isNewUser: true`, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ `/register` –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è. –ò–Ω–∞—á–µ ‚Äî –Ω–∞ –≥–ª–∞–≤–Ω—É—é –∏–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É.

### 2.1 –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞.
- **URL:** `/auth/register`
- **–ú–µ—Ç–æ–¥:** `POST`
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  { 
    "firstName": "–¢–∏–º—É—Ä", 
    "lastName": "–ê–ª–∏–µ–≤",
    "birthDate": "1995-05-20",
    "carBrand": "Toyota Camry",
    "email": "timur@example.com",
    "bio": "–ï–¥—É –∞–∫–∫—É—Ä–∞—Ç–Ω–æ, –ª—é–±–ª—é —Ç–∏—à–∏–Ω—É" 
  }
  ```
- **–û—Ç–≤–µ—Ç (200 OK):** –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### 3. –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è –ø–æ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏.
- **URL:** `/auth/me`
- **–ú–µ—Ç–æ–¥:** `GET`
- **–û—Ç–≤–µ—Ç (200 OK):** –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ `401 Unauthorized`.

### 4. –í—ã—Ö–æ–¥
–£–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏.
- **URL:** `/auth/logout`
- **–ú–µ—Ç–æ–¥:** `POST`

---

## üöó –ü–æ–µ–∑–¥–∫–∏ (Rides)

### 1. –ü–æ–∏—Å–∫ –ø–æ–µ–∑–¥–æ–∫
–ü–æ–∏—Å–∫ –ø–æ –º–∞—Ä—à—Ä—É—Ç—É –∏ –¥–∞—Ç–µ.
- **URL:** `/rides/search`
- **–ú–µ—Ç–æ–¥:** `GET`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (Query):** 
    - `from` (string) - –û—Ç–∫—É–¥–∞
    - `to` (string) - –ö—É–¥–∞
    - `date` (YYYY-MM-DD) - –î–∞—Ç–∞
    - `seats` (int) - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1)
- **–û—Ç–≤–µ—Ç (200 OK):**
  ```json
  [
    {
      "id": "uuid",
      "from": "–î—É—à–∞–Ω–±–µ",
      "to": "–•—É–¥–∂–∞–Ω–¥",
      "departureTime": "2024-02-21T08:00:00",
      "arrivalTime": "2024-02-21T12:30:00",
      "price": 120,
      "availableSeats": 3,
      "driver": { "firstName": "–ò–º—è", "rating": 4.8, "avatarUrl": "url" },
      "car": "Toyota Camry"
    }
  ]
  ```

### 2. –î–µ—Ç–∞–ª–∏ –ø–æ–µ–∑–¥–∫–∏
–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–µ–∑–¥–∫–µ.
- **URL:** `/rides/:id`
- **–ú–µ—Ç–æ–¥:** `GET`
- **–û—Ç–≤–µ—Ç (200 OK):** –û–±—ä–µ–∫—Ç –ø–æ–µ–∑–¥–∫–∏ —Å–æ –≤—Å–µ–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ (–æ–ø–∏—Å–∞–Ω–∏–µ, –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏, —Ç–µ–ª–µ—Ñ–æ–Ω –≤–æ–¥–∏—Ç–µ–ª—è).

### 3. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–µ–∑–¥–∫–∏
–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è).
- **URL:** `/rides`
- **–ú–µ—Ç–æ–¥:** `POST`
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:**
  ```json
  {
    "from": "–î—É—à–∞–Ω–±–µ",
    "to": "–ü–µ–Ω–¥–∂–∏–∫–µ–Ω—Ç",
    "departureTime": "ISO string",
    "price": 150,
    "totalSeats": 4,
    "description": "...",
    "car": "Lexus HS"
  }
  ```

### 4. –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã
–î–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
- **URL:** `/rides/popular`
- **–ú–µ—Ç–æ–¥:** `GET`
- **–û—Ç–≤–µ—Ç (200 OK):**
  ```json
  [
    { "from": "–î—É—à–∞–Ω–±–µ", "to": "–•—É–¥–∂–∞–Ω–¥", "price": "120 c" }
  ]
  ```

### 5. –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Å—Ç–∞
- **URL:** `/rides/:id/book`
- **–ú–µ—Ç–æ–¥:** `POST`
- **–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:** `{ "seats": 1 }`

---

## üìà –û—à–∏–±–∫–∏ (Error Handling)

–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:
- **–û—Ç–≤–µ—Ç:**
  ```json
  {
    "status": "error",
    "message": "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –Ω–∞ –ø–æ–Ω—è—Ç–Ω–æ–º —è–∑—ã–∫–µ",
    "code": 400
  }
  ```
